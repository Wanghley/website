{"ast":null,"code":"\"use client\";\n\nimport { appendParamsToURL, IS_SERVER } from './vidstack-C-WrcxmD.js';\nimport { signal, listenEvent, effect, peek, isString } from './vidstack-CH225ns1.js';\nclass EmbedProvider {\n  #iframe;\n  src = signal(\"\");\n  /**\n   * Defines which referrer is sent when fetching the resource.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy}\n   */\n  referrerPolicy = null;\n  get iframe() {\n    return this.#iframe;\n  }\n  constructor(iframe) {\n    this.#iframe = iframe;\n    iframe.setAttribute(\"frameBorder\", \"0\");\n    iframe.setAttribute(\"aria-hidden\", \"true\");\n    iframe.setAttribute(\"allow\", \"autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope\");\n    if (this.referrerPolicy !== null) {\n      iframe.setAttribute(\"referrerpolicy\", this.referrerPolicy);\n    }\n  }\n  setup() {\n    listenEvent(window, \"message\", this.#onWindowMessage.bind(this));\n    listenEvent(this.#iframe, \"load\", this.onLoad.bind(this));\n    effect(this.#watchSrc.bind(this));\n  }\n  #watchSrc() {\n    const src = this.src();\n    if (!src.length) {\n      this.#iframe.setAttribute(\"src\", \"\");\n      return;\n    }\n    const params = peek(() => this.buildParams());\n    this.#iframe.setAttribute(\"src\", appendParamsToURL(src, params));\n  }\n  postMessage(message, target) {\n    if (IS_SERVER) return;\n    this.#iframe.contentWindow?.postMessage(JSON.stringify(message), target ?? \"*\");\n  }\n  #onWindowMessage(event) {\n    const origin = this.getOrigin(),\n      isOriginMatch = (event.source === null || event.source === this.#iframe?.contentWindow) && (!isString(origin) || origin === event.origin);\n    if (!isOriginMatch) return;\n    try {\n      const message = JSON.parse(event.data);\n      if (message) this.onMessage(message, event);\n      return;\n    } catch (e) {}\n    if (event.data) this.onMessage(event.data, event);\n  }\n}\nexport { EmbedProvider };","map":{"version":3,"names":["appendParamsToURL","IS_SERVER","signal","listenEvent","effect","peek","isString","EmbedProvider","iframe","src","referrerPolicy","constructor","setAttribute","setup","window","onWindowMessage","bind","onLoad","watchSrc","#watchSrc","length","params","buildParams","postMessage","message","target","contentWindow","JSON","stringify","#onWindowMessage","event","origin","getOrigin","isOriginMatch","source","parse","data","onMessage","e"],"sources":["/Users/wanghley/Workspace/Projects/wanghley.com/node_modules/@vidstack/react/dev/chunks/vidstack-CFWvJYI8.js"],"sourcesContent":["\"use client\"\n\nimport { appendParamsToURL, IS_SERVER } from './vidstack-C-WrcxmD.js';\nimport { signal, listenEvent, effect, peek, isString } from './vidstack-CH225ns1.js';\n\nclass EmbedProvider {\n  #iframe;\n  src = signal(\"\");\n  /**\n   * Defines which referrer is sent when fetching the resource.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy}\n   */\n  referrerPolicy = null;\n  get iframe() {\n    return this.#iframe;\n  }\n  constructor(iframe) {\n    this.#iframe = iframe;\n    iframe.setAttribute(\"frameBorder\", \"0\");\n    iframe.setAttribute(\"aria-hidden\", \"true\");\n    iframe.setAttribute(\n      \"allow\",\n      \"autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope\"\n    );\n    if (this.referrerPolicy !== null) {\n      iframe.setAttribute(\"referrerpolicy\", this.referrerPolicy);\n    }\n  }\n  setup() {\n    listenEvent(window, \"message\", this.#onWindowMessage.bind(this));\n    listenEvent(this.#iframe, \"load\", this.onLoad.bind(this));\n    effect(this.#watchSrc.bind(this));\n  }\n  #watchSrc() {\n    const src = this.src();\n    if (!src.length) {\n      this.#iframe.setAttribute(\"src\", \"\");\n      return;\n    }\n    const params = peek(() => this.buildParams());\n    this.#iframe.setAttribute(\"src\", appendParamsToURL(src, params));\n  }\n  postMessage(message, target) {\n    if (IS_SERVER) return;\n    this.#iframe.contentWindow?.postMessage(JSON.stringify(message), target ?? \"*\");\n  }\n  #onWindowMessage(event) {\n    const origin = this.getOrigin(), isOriginMatch = (event.source === null || event.source === this.#iframe?.contentWindow) && (!isString(origin) || origin === event.origin);\n    if (!isOriginMatch) return;\n    try {\n      const message = JSON.parse(event.data);\n      if (message) this.onMessage(message, event);\n      return;\n    } catch (e) {\n    }\n    if (event.data) this.onMessage(event.data, event);\n  }\n}\n\nexport { EmbedProvider };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}